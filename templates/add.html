{% extends "base.html" %} {% block content %}
<h1>Add New Creature</h1>
<form method="POST" class="needs-validation" novalidate>
  <div class="row">
    <div class="col-md-6 mb-3">
      <label for="name" class="form-label">Name</label>
      <input type="text" class="form-control" id="name" name="name" required />
    </div>
    <div class="col-md-4 mb-3">
      <label for="type" class="form-label">Type</label>
      <select class="form-select" id="type" name="type" required>
        <option value="aberration">Aberration</option>
        <option value="beast">Beast</option>
        <option value="celestial">Celestial</option>
        <option value="construct">Construct</option>
        <option value="dragon">Dragon</option>
        <option value="elemental">Elemental</option>
        <option value="fey">Fey</option>
        <option value="fiend">Fiend</option>
        <option value="giant">Giant</option>
        <option value="humanoid">Humanoid</option>
        <option value="monstrosity">Monstrosity</option>
        <option value="ooze">Ooze</option>
        <option value="plant">Plant</option>
        <option value="undead">Undead</option>
      </select>
    </div>
    <div class="col-md-2 mb-3">
      <label for="type_tag" class="form-label">Type Tag (Optional)</label>
      <input
        type="text"
        class="form-control"
        id="type_tag"
        name="type_tag"
        placeholder="e.g. orc"
      />
    </div>
  </div>

  <div class="row">
    <div class="col-md-4 mb-3">
      <label for="size" class="form-label">Size</label>
      <select class="form-select" id="size" name="size" required>
        <option value="Tiny">Tiny</option>
        <option value="Small">Small</option>
        <option value="Medium">Medium</option>
        <option value="Large">Large</option>
        <option value="Huge">Huge</option>
        <option value="Gargantuan">Gargantuan</option>
      </select>
    </div>
    <div class="col-md-4 mb-3">
      <label for="alignment" class="form-label">Alignment</label>
      <select class="form-select" id="alignment" name="alignment" required>
        <option value="lawful good">Lawful Good</option>
        <option value="lawful neutral">Lawful Neutral</option>
        <option value="lawful evil">Lawful Evil</option>
        <option value="neutral good">Neutral Good</option>
        <option value="true neutral">True Neutral</option>
        <option value="neutral evil">Neutral Evil</option>
        <option value="chaotic good">Chaotic Good</option>
        <option value="chaotic neutral">Chaotic Neutral</option>
        <option value="chaotic evil">Chaotic Evil</option>
        <option value="unaligned">Unaligned</option>
      </select>
    </div>
    <div class="col-md-4 mb-3">
      <label for="challenge_rating" class="form-label">Challenge Rating</label>
      <select
        class="form-select"
        id="challenge_rating"
        name="challenge_rating"
        required
      >
        <option value="0">0</option>
        <option value="0.125">1/8</option>
        <option value="0.25">1/4</option>
        <option value="0.5">1/2</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="24">24</option>
        <option value="25">25</option>
        <option value="26">26</option>
        <option value="27">27</option>
        <option value="28">28</option>
        <option value="29">29</option>
        <option value="30">30</option>
      </select>
    </div>
  </div>

  <div class="mb-3">
    <label for="desc" class="form-label">Description</label>
    <textarea
      class="form-control"
      id="desc"
      name="desc"
      rows="3"
      required
    ></textarea>
  </div>

  <div class="mb-3">
    <label for="salvage" class="form-label"
      >Salvage Information (Optional)</label
    >
    <textarea
      class="form-control"
      id="salvage"
      name="salvage"
      rows="3"
    ></textarea>
    <div class="form-text">
      Leave blank if no salvage information is available.
    </div>
  </div>

  <div class="mb-3">
    <label class="form-label">Lore (Optional)</label>
    <div id="lore-container">
      <div class="input-group mb-2">
        <input
          type="text"
          class="form-control"
          name="lore[]"
          placeholder="Enter lore entry"
        />
        <button
          type="button"
          class="btn btn-danger remove-lore"
          onclick="removeLoreEntry(this)"
        >
          Remove
        </button>
      </div>
    </div>
    <button type="button" class="btn btn-secondary" onclick="addLoreEntry()">
      Add Lore Entry
    </button>
    <div class="form-text">
      Add any relevant lore entries. Leave empty if no lore is available.
    </div>
  </div>

  <div class="row">
    <div class="col-md-4 mb-3">
      <label for="armor_class" class="form-label">Armor Class</label>
      <input
        type="number"
        class="form-control"
        id="armor_class"
        name="armor_class"
      />
    </div>
    <div class="col-md-4 mb-3">
      <label for="hit_points" class="form-label">Hit Points</label>
      <input
        type="number"
        class="form-control"
        id="hit_points"
        name="hit_points"
      />
    </div>
    <div class="col-md-4 mb-3">
      <label for="hit_dice" class="form-label">Hit Dice</label>
      <input type="text" class="form-control" id="hit_dice" name="hit_dice" />
    </div>
  </div>

  <h3 class="mt-4">Speed (Optional)</h3>
  <div class="row">
    <div class="col-md-4 mb-3">
      <label for="speed_walk" class="form-label">Walk</label>
      <input
        type="text"
        class="form-control"
        id="speed_walk"
        name="speed_walk"
        placeholder="e.g. 30 ft."
      />
    </div>
    <div class="col-md-4 mb-3">
      <label for="speed_fly" class="form-label">Fly</label>
      <input
        type="text"
        class="form-control"
        id="speed_fly"
        name="speed_fly"
        placeholder="e.g. 60 ft."
      />
    </div>
    <div class="col-md-4 mb-3">
      <label for="speed_swim" class="form-label">Swim</label>
      <input
        type="text"
        class="form-control"
        id="speed_swim"
        name="speed_swim"
        placeholder="e.g. 30 ft."
      />
    </div>
  </div>
  <div class="row">
    <div class="col-md-6 mb-3">
      <label for="speed_climb" class="form-label">Climb</label>
      <input
        type="text"
        class="form-control"
        id="speed_climb"
        name="speed_climb"
        placeholder="e.g. 30 ft."
      />
    </div>
    <div class="col-md-6 mb-3">
      <label for="speed_burrow" class="form-label">Burrow</label>
      <input
        type="text"
        class="form-control"
        id="speed_burrow"
        name="speed_burrow"
        placeholder="e.g. 20 ft."
      />
    </div>
  </div>
  <div class="form-text mb-3">
    Enter speeds in feet (ft.) or leave blank if the creature doesn't have that
    movement type.
  </div>

  <h3 class="mt-4">Ability Scores</h3>
  <div class="row">
    <div class="col-md-2 mb-3">
      <label for="strength" class="form-label">STR</label>
      <input type="number" class="form-control" id="strength" name="strength" />
    </div>
    <div class="col-md-2 mb-3">
      <label for="dexterity" class="form-label">DEX</label>
      <input
        type="number"
        class="form-control"
        id="dexterity"
        name="dexterity"
      />
    </div>
    <div class="col-md-2 mb-3">
      <label for="constitution" class="form-label">CON</label>
      <input
        type="number"
        class="form-control"
        id="constitution"
        name="constitution"
      />
    </div>
    <div class="col-md-2 mb-3">
      <label for="intelligence" class="form-label">INT</label>
      <input
        type="number"
        class="form-control"
        id="intelligence"
        name="intelligence"
      />
    </div>
    <div class="col-md-2 mb-3">
      <label for="wisdom" class="form-label">WIS</label>
      <input type="number" class="form-control" id="wisdom" name="wisdom" />
    </div>
    <div class="col-md-2 mb-3">
      <label for="charisma" class="form-label">CHA</label>
      <input type="number" class="form-control" id="charisma" name="charisma" />
    </div>
  </div>

  <div class="row">
    <div class="col-md-6 mb-3">
      <label for="languages" class="form-label">Languages</label>
      <input type="text" class="form-control" id="languages" name="languages" />
    </div>
    <div class="col-md-6 mb-3">
      <label for="passive_perception" class="form-label"
        >Passive Perception</label
      >
      <input
        type="number"
        class="form-control"
        id="passive_perception"
        name="passive_perception"
      />
    </div>
  </div>

  <div class="mb-3">
    <button type="submit" class="btn btn-primary">Add Creature</button>
    <a href="{{ url_for('index') }}" class="btn btn-secondary">Cancel</a>
  </div>
</form>

<script>
  // Form validation
  (function () {
    'use strict';
    var forms = document.querySelectorAll('.needs-validation');
    Array.prototype.slice.call(forms).forEach(function (form) {
      form.addEventListener(
        'submit',
        function (event) {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add('was-validated');
        },
        false
      );
    });
  })();

  // Lore entry management
  function addLoreEntry() {
    const container = document.getElementById('lore-container');
    const newEntry = document.createElement('div');
    newEntry.className = 'input-group mb-2';
    newEntry.innerHTML = `
      <input type="text" class="form-control" name="lore[]" placeholder="Enter lore entry">
      <button type="button" class="btn btn-danger remove-lore" onclick="removeLoreEntry(this)">Remove</button>
    `;
    container.appendChild(newEntry);
  }

  function removeLoreEntry(button) {
    const entry = button.parentElement;
    const container = document.getElementById('lore-container');

    // Don't remove if it's the last entry
    if (container.children.length > 1) {
      entry.remove();
    }
  }
</script>
{% endblock %}
